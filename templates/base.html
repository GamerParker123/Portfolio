<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title if title else "Portfolio" }}</title>
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    {% block head %}{% endblock %}
</head>
<body data-project-key="{{ key if key else '' }}">
    <div class="layout">
        <aside class="sidebar">
            <h3>Navigation</h3>
            <ul>
            <li><a href="/">âœ… Project Checklist</a></li>
            </ul>
            {% for size, label in [("big","Major Projects"), ("beginning","The Beginning..."), ("medium","Medium Projects"), ("small","Small Projects")] %}
                <h4>{{ label }}</h4>
                <ul>
                {% for key, project in projects.items() if project.size == size %}
                    <li>
                        <a href="{{ url_for('project', key=key) }}">{{ project.emoji }} {{ project.title }}</a>
                    </li>
                {% endfor %}
                </ul>
            {% endfor %}

            <h4>The Journal</h4>
            <ul class="bottom-links">
                <li><a href="{{ url_for('devlogs') }}">ðŸ““ Journal Devlogs</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div id="progress-container">
                <div id="progress-bar"></div>
                <span id="progress-text">0%</span>
            </div>

            {% block content %}{% endblock %}
        </main>
    </div>

    <footer>
        <p>&copy; {{ 2025 }} Konner Knoll</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    {% block scripts %}
    <script>

        // Total number of projects
        const totalProjects = Object.keys({{ projects|tojson }}).length;

        // Mark current project as visited
        if (currentProject) {
            visitedProjects[currentProject] = true;
            localStorage.setItem('visitedProjects', JSON.stringify(visitedProjects));
        }

        function updateProgressBar() {
            const visited = Object.keys(visitedProjects).length;
            const progress = (visited / totalProjects) * 100;

            const bar = document.getElementById('progress-bar');
            if (bar) bar.style.width = progress + '%';

            const progressText = document.getElementById('progress-text');
            if (progressText) progressText.textContent = Math.round(progress) + '%';
        }

        updateProgressBar();
    </script>
    {% endblock %}
</body>
</html>
